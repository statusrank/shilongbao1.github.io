---
title: CNN经典模型----VGGNet
copyright: true
mathjax: true
tags: VGGNet
categories: 深度学习
abbrlink: 6c09b258
date: 2018-10-15 14:50:57
updated:
---
[转载来源,再次感谢](https://my.oschina.net/u/876354/blog/1634322)
VGGNet探索了卷积神经网络的深度与其性能之间的关系,成功地构筑了16~19层深的卷积神经网络,证明了增加网络的深度能够在一定程度上影响网络的最终性能,使得错误率大幅下降,同时拓展性又很强,迁移到其他图片数据上的泛化性也非常好。到目前为止,VGG仍然被用来提取图像特征。
VGGNet可以看成是加深版本的AlexNet,都是由卷积层、全连接层两大部分组成。
<!--more-->
{% asset_img 1.png %}
##VGG特点
先看一下VGG的结构图
{% asset_img 2.png %}
###**1.结构简洁**
VGG由5层卷积层、3层全连接层、softmax输出层构成,层与层之间使用最大池化(max-pooling)分开,所有隐层的激活单元都采用ReLu函数。
###**2.小卷积核和多卷积子层**
VGG使用多个较小卷积核($ 3 \times 3$)的卷积层代替一个卷积核较大的卷积层,一方面可以减少参数,另一方面相当于进行了更多的非线性映射,可以增加网络的拟合/表达能力。
**小卷积核**是VGGNet的一个重要特点,虽然VGG是在模仿AlexNet的网络结构,但没有采用AlexNet中的比较大的卷积核尺寸($ 7\times 7$),而是通过降低卷积核的大小($3\times3$),增加卷积子层来达到同样性能(VGG：从1到4卷积子层,ALexNet:1子层)
**作者认为两个$3\times3$的卷积堆叠获得的感受野大小相当于一个$5\times5$的卷积。三个$3\times3$的卷积堆叠得到的感受野相当于一个$7times7$的卷积。这样可以增加非线性映射,也可以很好的减少参数(一个$7\times7$参数为49,而三个$3\times3$参数为27)**
如图:{% asset_img 1.jpg %}
最下面是一个$5\times5$的卷积核,我们使用$3\times3$的卷积核对这个$5\times5$的卷积核进行操作,得到$3\times3$的图,再使用$3\times3$的卷积核对该图进行卷积最后得到$1\times1$,故感受野和$5\times5$相同,且由于在每一个卷积后都会加上ReLu激活函数,所以也增加了非线性。
###3.小池化核
相比AlexNet的$3\times3$的池化核mVGG全部采用$2\times2$的池化核
###4.通道数多
VGG网络第一层的通道数为64,后面每层都进行了翻倍,最多到512个通道,通道数的增加,使得更多的信息可以被提取出来。
###5.层数更深、特征图更宽
由于卷积核专注于扩大通道数,池化专注于缩小宽和高,使得模型架构上更深更宽的同时,控制了计算量的增加规模。
###6.全连接转卷积(测试阶段)
这也是VGG的一个特点,在网络测试阶段将训练阶段的三个全连接层替换为三个卷积,使得测试得到的全卷积网络因为没有全连接的限制,因而可以接受任意宽和高的输入,这在测试阶段很重要。
如本节第一个图所示，输入图像是$224\times 224\times 3$，如果后面三个层都是全连接，那么在测试阶段就只能将测试的图像全部都要缩放大小到$224\times 224\times 3$，才能符合后面全连接层的输入数量要求，这样就不便于测试工作的开展。
这里全连接和卷积层之间的替换和滑动窗口算法那里的替换是同一个思想:
{% asset_img 3.png %}
例如$7\times 7\times 512$的层要跟4096个神经元的层做全连接，则替换为对$7\times 7\times 512$的层作通道数为4096、卷积核为$1\times 1$的卷积。
这个“全连接转卷积”的思路是VGG作者参考了OverFeat的工作思路，例如下图是OverFeat将全连接换成卷积后，则可以来处理任意分辨率（在整张图）上计算卷积，这就是无需对原图做重新缩放处理的优势。{% asset_img 4.png %}
##VGG的网络结构
如下图:
{% asset_img 5.png %}
在这篇论文中分别使用了A、A-LRN、B、C、D、E这6种网络结构进行测试，这6种网络结构相似，**都是由5层卷积层、3层全连接层组成**，其中区别在于每个卷积层的子层数量不同，从A至E依次增加（子层数量从1到4），总的网络深度从11层到19层（添加的层以粗体显示），表格中的卷积层参数表示为“conv⟨感受野大小⟩-通道数⟩”，例如con3-128，表示使用$3\times3$的卷积核，通道数为128。为了简洁起见，在表格中不显示ReLU激活功能。
其中，网络结构D就是著名的VGG16，网络结构E就是著名的VGG19。

以网络结构D（VGG16）为例，介绍其处理过程如下，请对比上面的表格和下方这张图，留意图中的数字变化，有助于理解VGG16的处理过程：{% asset_img 6.png %}
1.输入$224\times224\times3$的图片,经64个$3\times3$的卷积核做**两次**卷积+ReLu,卷积后尺寸变为$224\times224\times64$
2.做max-pooling,池化但愿尺寸为$2\times2$使得图像尺寸减半,池化后的尺寸变为$112\times112\times64$
3.经过128个$3\times3$的卷积核做**三次**卷积+ReLu，尺寸变为$112\times112\times128$
4.做$2\times2$的最大池化,尺寸变为$56\times56\times128$
5.经过256个$3\times3$的卷积核作**三次**卷积+ReLu,尺寸变为$56\times56\times256$
6.做$2\times2$的最大池化,尺寸变为$28\times28\times256$
7.经过512个$3\times3$的卷积核作**三次**卷积+ReLu,尺寸变为$28\times28\times512$
8.做$2\times2$的最大池化,尺寸变为$14\times14\times512$
9.经过512个$3\times3$的卷积核作**三次**卷积+ReLu,尺寸变为$14\times14\times512$
10.做$2\times2$的最大池化,尺寸变为$7\times7\times512$
11.与两层$1\times1\times4096$，一层$1\times1\times1000$进行全连接+ReLu(共三层)
12.通过softmax预测出1000个输出结果
从上面的过程可以看出**VGG网络结构还是挺简洁的，都是由小卷积核、小池化核、ReLU组合而成**。其简化图如下（以VGG16为例）：
{%asset_img 7.png %}
A、A-LRN、B、C、D、E这6种网络结构的深度虽然从11层增加至19层，但参数量变化不大，这是由于基本上都是采用了小卷积核（3x3，只有9个参数），这6种结构的参数数量（百万级）并未发生太大变化，这是因为在网络中，参数主要集中在全连接层。{%asset_img 8.png %}经作者对A、A-LRN、B、C、D、E这6种网络结构进行单尺度的评估，错误率结果如下：{%asset_img 9.png %}
从上表可以看出：
1、LRN层无性能增益（A-LRN）
VGG作者通过网络A-LRN发现，AlexNet曾经用到的LRN层（local response normalization，局部响应归一化）并没有带来性能的提升，因此在其它组的网络中均没再出现LRN层。
2、随着深度增加，分类性能逐渐提高（A、B、C、D、E）
从11层的A到19层的E，网络深度增加对top1和top5的错误率下降很明显。
3、多个小卷积核比单个大卷积核性能好（B）
VGG作者做了实验用B和自己一个不在实验组里的较浅网络比较，较浅网络用conv5x5来代替B的两个conv3x3，结果显示多个小卷积核比单个大卷积核效果要好。
##小结
1.通过增加深度能有效的提升性能
2.最佳模型:VGG16,从头到尾只有$3\times3$的卷积核$2\times2$的池化,简洁优美
3.卷积可以代替全连接,可适应各种尺寸的图片