---
title: 机器学习中的降维方法——————多维缩放(MDS)&& 等度量映射(IsoMap)
copyright: true
mathjax: true
tags: 机器学习
categories: 机器学习
abbrlink: bc7a8022
date: 2018-10-30 20:51:10
updated:
---
##关于降维
降维:通过某种数字变换将原始高维属性空间转变为一个低维"子空间",在这个子空间中样本密度大幅提高,距离计算也变的更为容易。
###为什么需要降维？
在高维情况下回出现数据样本稀疏、距离计算困难等问题,是所有机器学习方法共同面临的严重障碍,被称为“维数灾难”.
###为什么能降维？
因为在很多时候,人们观测或收集到的数据样本虽是高维的,但与学习任务密切相关的也许仅是某个低维分布,即高维空间中的一个低维嵌入（embedding）.
<!--more-->
##多维缩放(MDS)
###算法思想
MDS算法思想很简单，一句话就是**保持样本在原空间和低维空间的距离不变。**
因为距离是样本之间一个很好的分离属性，对于大多数聚类算法来说，距离是将样本分类的重要属性，因此当我们降维后，保持距离不变，那么就相当于保持了样本的相对空间关系不变。
###MDS
假设n个样本在原始空间的距离矩阵为D,其第i行第j列的元素$d_{ij}$为样本$x_i$到$x_j$的距离。我们的目标是获得样本在d'维空间的表示Z,且任意两个样本在d'维空间中的**欧式距离等于原始空间中的距离,即$||z_i - z_j|| = d_{ij}$**

令$ B = Z^TZ$降维后的内积矩阵,则$B_{ij} = z_iz_j^T$
$d_{ij} = （z_i - z_j)^2 = ||z_i||^2 + ||z_j||^2 -2z_iz_j^T  = b_{ii} + b_{jj} -2b_{ij}$ 
我们知道给定一个距离矩阵D,如图{% asset_img 1.png %}。对所有的点进行平移、旋转、翻转对距离是没有影响的,所以为了便于讨论这里我们假设对$Z$进行中心化,即将数据的中心点平移到原点,于是有$\sum_i^n z_i = 0$
所以有:{% asset_img 2.png %}.
**可以看到矩阵B的行列之和都为0**.
设T为B的trace = $\sum_i^n ||z_i||^2 = \sum_i^n bii$,则有:{% asset_img 3.png %}
根据上面矩阵D的计算我们可以得到 {% asset_img 4.png %}
而根据前面的计算我们可以得到:{% asset_img 5.png %}
所以:{% asset_img 6.png %}
可以看到他们三个分别是$D^2$的行均值,列均值和矩阵的均值。由此**我们可以通过降维后保持不变的距离矩阵D求得内积矩阵B.**因为矩阵B是一个对称矩阵,所以我们对B进行**特征值分解** $B = V\Lambda V^{-1} = V\Lambda V^T$ 
$\Lambda$为特征值构成的对角阵,按从大到小排序,$V$是对应特征向量矩阵。
上面我们说到,B是降维后的内积Z,现在我们通过距离矩阵D计算出内积矩阵B,并对其进行了特征分解；那么我们只需要令$V\Lambda V^T = Z^TZ$，从而求得$Z = \Lambda^{\frac{1}{2}}V^T$
**在现实应用中为了有效降维,往往仅需降维后的距离与原始空间的距离尽可能的接近,而不必严格相等。此时可以取d'远小于d个特征值构成对角矩阵,从而达到降维的目的。当d'=d时,此时得到的ZZ就是原数据去中心化并做了某种正交变换后的值了(这里是因为正交变换不会改变向量大小,所以给定距离矩阵D我们无法还原出原数据)**。
###MDS算法描述
输入: 给定距离矩阵D
过程:
1.根据公式计算求得内积矩阵B
2.对矩阵B做特征分解
3.取d'个最大特征值构成的对角阵和对应特征向量构成的V
4.输出: $ V\Lambda^{\frac{1}{2}}$每行是一个样本的低维坐标

##等度量映射(Isomap)
Iso所改造的是MDS,它的目的就是使得降维后的点两两之间距离不变,但是MDS是基于欧式距离的,如果数据分布在一个流形上的话MDS就不适应了。
等度量映射的基本出发点是认为低维流形嵌入到高维空间之后,直接计算高维空间中的直线距离具有误导性,这里所说的降维后的两点之间的距离不变指的是**测地距离**。
解释一下测地距离，例如在地球上，要从南极到北极，欧式距离就是两点之间直线最短，测地距离则是曲线的长度，更符合实际情况。
欧式距离示意图:{%asset_img 7.png %}
测地距离示意图:{%asset_img 8.png %}
###如何计算测地距离呢？
我们可以利用流形在聚不上与欧式空间同胚这个性质,对每个点基于欧式距离找出其近邻点,然后就能建立一个近邻连接图,图中近邻点之间存在连接,而非近邻点之间不存在连接,于是计算两点之间的测地距离的问题,就转化为**计算近邻连接上两点之间的最短路径**,可以使用dij或者Floyd.此时我们就得到了任意两点间的距离矩阵D,剩下的就是MDS算法了。
###算法过程
输入:
样本集 $(x_1,x_2,...x_m)$，近邻参数看、,低维空间维数d'
过程:
1.for i = 1,2....m do
  确定$x_i$的近邻k
  $x_i$与近邻点之间的距离设为欧式距离,其余的设为无穷大
2.调用最短路径算法计算任意两样本点之间的距离dis
3.将得到的距离矩阵D作为MDS算法的输入
输出：样本在低维空间的输出$Z = (z_1,z_2,z_m)$